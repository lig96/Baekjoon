# [Gold II] Непредусмотрительные спелеологи - 30851 

[문제 링크](https://www.acmicpc.net/problem/30851) 

### 성능 요약

메모리: 144680 KB, 시간: 692 ms

### 분류

데이크스트라, 그래프 이론, 최단 경로

### 제출 일자

2023년 12월 13일 19:36:23

### 문제 설명

<p>Однажды группа спелеологов отправилась покорять африканские пещеры. Углубившись достаточно далеко, они обнаружили что-то странное — пахло дымом. «Неужели мы подобрались к вулкану?» — удивленно спросил новичок. «Нет. Около вулкана пахнет серой», — ответил капитан. «Кто у нас занимался тушением костров?». Все неуверенно пожали плечами. «Итак, друзья, мы в ловушке».</p>

<p>Перед капитаном команды спелеологов возникла непосильная задача: как же вывести свою группу из пещеры, не сгорев? Пещера в терминах спелеологов состоит из множества «тоннелей» и «станций». Каждый тоннель соединяет какую-нибудь пару различных станций и имеет свою длину. У капитана имеется карта пещеры, и он знает, где они разводили костры, и где находится выход из пещеры.</p>

<p>Каждую секунду дым распространяется на 1 метр. Таким образом, тоннель длины k, смежный с уже задымленной станцией, заполнится дымом за k секунд, а также заполнится дымом и соответствующая станция. Если спелеологи находятся на станции, где есть дым, они задыхаются. Спелеологи бегут со скоростью 1 метр в секунду. Изначально дым есть только в тех станциях, где спелеологи разводили костры.</p>

<p>Перемещаться по тоннелям можно в обе стороны. Если спелеологи прибывают на станцию одновременно с дымом, то они задыхаются (это верно и для той станции, где расположен выход). Гарантируется, что сейчас спелеологи находятся на станции, где нет дыма.</p>

### 입력 

 <p>В первой строке входных данных содержится три целых числа N, M и K — количество станций, тоннелей и станций с кострами соответственно (2 ≤ N ≤ 2 · 10<sup>5</sup>, 0 ≤ M ≤ 2 · 10<sup>5</sup>, 1 ≤ K < N).</p>

<p>Во второй строке содержится K различных чисел a<sub>i</sub> — номера станций, в которых спелеологи разводили костры (1 ≤ a<sub>i</sub> ≤ N).</p>

<p>Следующие M строк описывают тоннели. Каждое описание состоит из трех чисел x<sub>i</sub>, y<sub>i</sub> и l<sub>i</sub>, обозначающих номера станций, которые соединяет i-ый тоннель, и его длину в метрах (1 ≤ x<sub>i</sub>, y<sub>i</sub> ≤ N, 1 ≤ l<sub>i</sub> ≤ 10<sup>9</sup>, x<sub>i</sub> ≠ y<sub>i</sub>).</p>

<p>В последней строке входных данных содержится 2 числа S и F — номер станции, на которой сейчас находятся спелеологи и номер станции, в которой находится выход из пещеры (1 ≤ S, F ≤ N).</p>

### 출력 

 <p>Выведите единственное число — минимальное количество секунд, которое требуется спелеологам для того, чтобы выбраться из пещеры, либо «-1», если спелеологам не удастся выбраться.</p>

